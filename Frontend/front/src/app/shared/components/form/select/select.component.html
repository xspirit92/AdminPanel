<div #dropdownContainer class="relative">
  <!-- Основное поле выбора -->
  <div class="relative">
    <button
      type="button"
      (click)="toggleDropdown()"
      [disabled]="disabled"
      class="h-11 w-full appearance-none rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 pr-11 text-left text-sm shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 disabled:cursor-not-allowed disabled:opacity-50 {{ className }}"
      [ngClass]="{ 'dark:text-white/90': value }"
      [class.text-gray-800]="value"
      [class.text-gray-400]="!value"
      [class.dark:text-gray-400]="!value"
    >
      <span class="block truncate">
        {{ displayValue }}
      </span>
    </button>
    
    <!-- Иконка стрелки -->
    <span class="absolute text-gray-500 -translate-y-1/2 pointer-events-none right-3 top-1/2 dark:text-gray-400">
      <svg 
        class="transition-transform duration-200" 
        [class.rotate-180]="isOpen" 
        width="16" 
        height="16" 
        viewBox="0 0 16 16" 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg"
      >
        <path 
          d="M4 6L8 10L12 6" 
          stroke="currentColor" 
          stroke-width="1.5" 
          stroke-linecap="round" 
          stroke-linejoin="round"
        />
      </svg>
    </span>
  </div>

  <!-- Выпадающий список -->
  @if (isOpen) {
  <div class="absolute z-50 mt-1 w-full rounded-lg border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-800">
    
    <!-- Поле поиска -->
    @if (searchable) {
    <div class="border-b border-gray-200 p-2 dark:border-gray-700">
      <div class="relative">
        <input
          #searchInput
          type="text"
          [placeholder]="'Поиск...'"
          [value]="searchQuery"
          (input)="onSearchChange($event)"
          class="w-full rounded-lg border border-gray-300 bg-white px-3 py-2 pl-9 pr-8 text-sm text-gray-800 placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-2 focus:ring-brand-500/10 dark:border-gray-600 dark:bg-gray-700 dark:text-white/90 dark:placeholder:text-gray-400 dark:focus:border-brand-600"
        />
        
        <!-- Иконка поиска -->
        <svg class="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>

        <!-- Кнопка очистки поиска -->
        @if (searchQuery) {
        <button
          type="button"
          (click)="clearSearch()"
          class="absolute right-2 top-1/2 h-5 w-5 -translate-y-1/2 rounded-full text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
        >
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
        }
      </div>
    </div>
    }

    <!-- Список опций -->
    <div class="max-h-60 overflow-y-auto py-2">
      @if (filteredOptions.length === 0) {
        <!-- Сообщение, когда ничего не найдено -->
        <div class="px-3 py-2 text-center text-sm text-gray-500 dark:text-gray-400">
          Ничего не найдено
        </div>
      } @else {
        @for (option of filteredOptions; track option.value) {
        <button
          type="button"
          (click)="selectOption(option)"
          class="flex w-full items-center rounded-lg px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700"
          [ngClass]="{ 'dark:bg-brand-500/20': value === option.value }"
          [class.bg-brand-50]="value === option.value"
          [class.text-brand-700]="value === option.value"
          [class.dark:text-brand-300]="value === option.value"
        >
          <span class="block truncate">{{ option.label }}</span>
          
          <!-- Иконка выбранной опции -->
          @if (value === option.value) {
          <svg class="ml-auto h-4 w-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
          </svg>
          }
        </button>
        }
      }
    </div>
  </div>
  }
</div>