<div class="rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark">
  <div class="border-b border-stroke px-6.5 py-4 dark:border-strokedark">
    <h3 class="font-medium text-black dark:text-white">
      {{ isEditMode ? 'Редактирование закупки' : 'Создание новой закупки' }}
    </h3>
  </div>

  <form [formGroup]="purchaseForm" (ngSubmit)="onSubmit()" class="p-6.5">
    <div class="mb-4.5 grid grid-cols-1 gap-6 md:grid-cols-2">
      <!-- Поставщик -->
      <div class="w-full">
        <label class="mb-3 block text-sm font-medium text-black dark:text-white">
          Поставщик *
        </label>
        <select 
          formControlName="supplierId"
          class="w-full rounded border border-stroke bg-gray-50 py-3 px-4.5 text-black focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:text-white dark:focus:border-primary"
          [class.border-danger]="submitted && f['supplierId'].errors"
        >
          <option value="">Выберите поставщика</option>
          <option *ngFor="let supplier of suppliers" [value]="supplier.id">
            {{ supplier.name }}
          </option>
        </select>
        <div *ngIf="submitted && f['supplierId'].errors" class="mt-1 text-sm text-danger">
          Выберите поставщика
        </div>
      </div>

      <!-- Объект -->
      <div class="w-full">
        <label class="mb-3 block text-sm font-medium text-black dark:text-white">
          Объект *
        </label>
        <select 
          formControlName="facilityId"
          class="w-full rounded border border-stroke bg-gray-50 py-3 px-4.5 text-black focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:text-white dark:focus:border-primary"
          [class.border-danger]="submitted && f['facilityId'].errors"
        >
          <option value="">Выберите объект</option>
          <option *ngFor="let facility of facilities" [value]="facility.id">
            {{ facility.name }}
          </option>
        </select>
        <div *ngIf="submitted && f['facilityId'].errors" class="mt-1 text-sm text-danger">
          Выберите объект
        </div>
      </div>
    </div>

    <div class="mb-4.5 grid grid-cols-1 gap-6 md:grid-cols-2">
      <!-- Продукт -->
      <div class="w-full">
        <label class="mb-3 block text-sm font-medium text-black dark:text-white">
          Продукт *
        </label>
        <select 
          formControlName="productId"
          class="w-full rounded border border-stroke bg-gray-50 py-3 px-4.5 text-black focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:text-white dark:focus:border-primary"
          [class.border-danger]="submitted && f['productId'].errors"
        >
          <option value="">Выберите продукт</option>
          <option *ngFor="let product of products" [value]="product.id">
            {{ product.name }}
          </option>
        </select>
        <div *ngIf="submitted && f['productId'].errors" class="mt-1 text-sm text-danger">
          Выберите продукт
        </div>
      </div>

      <!-- Количество -->
      <div class="w-full">
        <label class="mb-3 block text-sm font-medium text-black dark:text-white">
          Количество *
        </label>
        <input
          type="number"
          formControlName="quantity"
          step="0.1"
          min="0.1"
          placeholder="Введите количество"
          class="w-full rounded border border-stroke bg-gray-50 py-3 px-4.5 text-black focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:text-white dark:focus:border-primary"
          [class.border-danger]="submitted && f['quantity'].errors"
        />
        <div *ngIf="submitted && f['quantity'].errors" class="mt-1 text-sm text-danger">
          <div *ngIf="f['quantity'].errors?.['required']">Введите количество</div>
          <div *ngIf="f['quantity'].errors?.['min']">Количество должно быть больше 0</div>
        </div>
      </div>
    </div>

    <div class="mb-4.5">
      <!-- Сумма -->
      <div class="w-full md:w-1/2">
        <label class="mb-3 block text-sm font-medium text-black dark:text-white">
          Сумма (руб) *
        </label>
        <input
          type="number"
          formControlName="amount"
          step="0.01"
          min="0"
          placeholder="Введите сумму"
          class="w-full rounded border border-stroke bg-gray-50 py-3 px-4.5 text-black focus:border-primary dark:border-strokedark dark:bg-meta-4 dark:text-white dark:focus:border-primary"
          [class.border-danger]="submitted && f['amount'].errors"
        />
        <div *ngIf="submitted && f['amount'].errors" class="mt-1 text-sm text-danger">
          <div *ngIf="f['amount'].errors?.['required']">Введите сумму</div>
          <div *ngIf="f['amount'].errors?.['min']">Сумма должна быть положительной</div>
        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex justify-end gap-3 mt-8">
      <button
        type="button"
        (click)="onCancel()"
        class="flex justify-center rounded border border-stroke py-2 px-6 font-medium text-black hover:shadow-1 dark:border-strokedark dark:text-white"
      >
        Отмена
      </button>
      <button
        type="submit"
        [disabled]="loading"
        class="flex justify-center rounded bg-primary py-2 px-6 font-medium text-gray-100 hover:bg-opacity-90 disabled:opacity-50"
      >
        {{ loading ? 'Сохранение...' : (isEditMode ? 'Обновить' : 'Создать') }}
      </button>
    </div>
  </form>
</div>